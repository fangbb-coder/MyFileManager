# 文件夹管理工具（Myfile）

一个功能强大的桌面端文件夹管理工具，集成了多种实用功能：文件夹同步、相同文件比对、重复文件查找、文件夹搜身和文件夹大小分析，帮助您高效管理文件系统。

## 功能特点

### 1. 文件夹同步
- **多种同步模式**：支持单向同步(A→B、B→A)和双向同步(A↔B)
- **智能同步逻辑**：自动比较文件名、修改时间与文件大小，仅同步必要的文件
- **同步删除选项**：可选择是否删除目标中多余的文件
- **文件过滤**：支持忽略特定文件模式（如`*.tmp, *.bak`）
- **同步预览**：在实际操作前预览将要执行的所有操作
- **进度显示**：实时显示同步进度和当前处理的文件
- **默认为空**：启动时不自动选择文件夹，等待用户手动选择

### 2. 相同文件比对
- **内容比对**：基于文件内容（大小和哈希）查找两个文件夹中相同的文件，不依赖文件名
- **文件过滤**：支持忽略特定文件模式
- **直观展示**：清晰列出比对结果，显示每对相同文件的路径
- **删除管理**：支持删除单个或批量删除比对结果中的文件
- **删除确认**：删除前显示详细的文件列表确认对话框
- **回收站支持**：删除的文件会移动到回收站，可恢复
- **右键菜单**：支持右键打开文件所在文件夹和删除文件
- **手动触发**：选择两个文件夹后不会自动开始比对，需手动点击"查找相同文件"按钮

### 3. 重复文件查找
- **重复检测**：在单个文件夹中查找内容完全相同的重复文件
- **高效算法**：使用MD5哈希算法准确识别重复内容
- **智能排序**：按文件大小降序排列，优先显示占用空间大的重复文件
- **一键清理**：默认选中每组除第一个外的重复文件，方便快速删除
- **灵活选择**：支持手动选择要保留或删除的文件
- **删除确认**：删除前显示详细的文件列表确认对话框
- **回收站支持**：删除的文件会移动到回收站，可恢复
- **右键菜单**：支持右键打开文件所在文件夹和删除文件

### 4. 文件夹搜身
- **大文件扫描**：扫描并找出占用空间最大的文件
- **排序展示**：按文件大小降序排列，直观显示最大的文件
- **信息丰富**：显示文件名、路径、大小和修改时间
- **快速定位**：帮助用户快速定位占用大量磁盘空间的文件
- **批量操作**：支持复制、移动、删除选中的文件
- **单位换算**：自动将文件大小转换为合适的单位（B、KB、MB、GB、TB）
- **智能排序**：点击表头可按任意列排序，大小列按实际字节数值排序
- **删除管理**：支持直接删除不需要的大文件
- **删除确认**：删除前显示详细的文件列表确认对话框
- **回收站支持**：删除的文件会移动到回收站，可恢复
- **右键菜单**：支持右键打开文件所在文件夹和删除文件

### 通用功能
- **直观界面**：五个功能标签页，操作简单明了
- **实时日志**：详细记录所有操作，便于追踪和问题排查
- **进度监控**：所有扫描和同步任务均显示实时进度
- **异常处理**：完善的错误捕获和提示机制
- **多平台支持**：同时支持PyQt6和Tkinter，适应不同环境
- **回收站集成**：所有删除操作都支持移动到回收站（Windows系统）
- **右键菜单**：文件列表支持右键打开文件所在文件夹和删除文件

## 技术栈

- **编程语言**：Python 3
- **图形界面**：PyQt6（默认）或 Tkinter（备选）
- **主要依赖**：os, shutil, hashlib, datetime, threading, send2trash

## 安装说明

### 方法一：使用Python直接运行

1. 确保已安装Python 3.7+
2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```
3. 运行程序：
   ```bash
   python main.py
   ```

### 方法二：打包为单文件EXE（Windows）

1. 安装pyinstaller：
   ```bash
   pip install pyinstaller
   ```
2. 打包程序：
   ```bash
   pyinstaller --onefile --windowed --icon=smart_file_icon.png main.py
   ```
   - 使用项目中已有的smart_file_icon.png作为图标
   - 生成的可执行文件将位于dist目录中
   - 打包后的程序可以直接运行，无需安装Python环境

## 使用方法

### 1. 文件夹同步
1. 切换到"文件夹同步"标签页
2. 点击"浏览"按钮分别选择源文件夹A和目标文件夹B
3. 在下拉框中选择所需的同步模式（A→B、B→A或双向同步）
4. （可选）在忽略规则文本框中输入要忽略的文件模式，如`*.tmp, *.bak`
5. （可选）勾选"同步删除"选项，以删除目标中多余的文件
6. 点击"预览"按钮查看将要执行的操作，或直接点击"开始同步"执行同步
7. 同步过程中可点击"暂停"、"继续"或"停止"按钮控制同步过程

### 2. 相同文件比对
1. 切换到"相同文件比对"标签页
2. 点击"浏览"按钮分别选择要比对的两个文件夹A和B
3. （可选）设置忽略规则，如`*.tmp, *.bak`
4. 点击"查找相同文件"按钮开始查找相同文件
5. 比对完成后，结果将显示在列表中
6. 可以选择单个文件右键删除，或使用表格上方的删除按钮批量删除
7. 删除前会显示确认对话框，列出要删除的文件
8. 删除的文件会移动到回收站

### 3. 重复文件查找
1. 切换到"重复文件查找"标签页
2. 点击"浏览"按钮选择要扫描的文件夹
3. 点击"开始扫描"按钮开始查找重复文件
4. 扫描完成后，重复文件将按组显示，每组为内容相同的文件
5. 系统默认选中每组除第一个外的重复文件
6. 可以调整选择，决定保留哪些文件
7. 点击"删除选中文件"按钮删除选择的文件
8. 删除前会显示确认对话框，列出要删除的文件
9. 删除的文件会移动到回收站

### 4. 文件夹搜身
1. 切换到"文件夹搜身"标签页
2. 点击"浏览"按钮选择要扫描的文件夹
3. 点击"开始扫描"按钮开始查找大文件
4. 扫描完成后，将显示前100个最大的文件（按大小降序排列）
5. 可以查看文件名、大小和修改时间信息
6. 选中不需要的大文件，点击"删除选中文件"按钮进行清理
7. 或使用"复制所选文件"、"移动所选文件"按钮进行批量操作
8. 删除前会显示确认对话框，列出要删除的文件
9. 删除的文件会移动到回收站

### 5. 文件夹大小
1. 切换到"文件夹大小"标签页
2. 点击"浏览"按钮选择要分析的文件夹
3. 点击"开始计算"按钮开始分析子文件夹
4. 扫描完成后，将显示所有子文件夹的信息（按文件数量降序排列）
5. 可以查看文件夹名称、路径、大小、文件数量和修改时间
6. 选中不需要的文件夹，点击"删除所选文件夹"按钮进行清理
7. 或使用"复制所选文件夹"、"移动所选文件夹"按钮进行批量操作
8. 删除前会显示确认对话框，列出要删除的文件夹

## 文件结构

- `main.py`：主程序入口，包含早期日志设置
- `sync_engine.py`：同步核心逻辑，处理文件同步和比对
- `ui_main.py`：图形界面实现，包含PyQt6和Tkinter双引擎支持
- `ui_components.py`：UI组件模块，包含可复用的界面元素
- `ui_threads.py`：工作线程模块，处理后台任务
- `ui_sync.py`：同步功能模块
- `ui_find_same.py`：相同文件比对功能模块
- `ui_find_duplicate.py`：重复文件查找功能模块
- `ui_file_slimming.py`：文件夹搜身功能模块
- `config_manager.py`：配置文件管理模块
- `utils.py`：工具函数，提供通用功能
- `requirements.txt`：项目依赖列表
- `smart_file_icon.png`：应用程序图标
- `README.md`：详细的使用说明文档
- `dist/`：打包输出目录，包含可执行文件
- `log.txt`：操作日志（自动生成）

## 注意事项

- 请在执行同步操作前确认文件夹路径正确
- 双向同步时，如果两边文件同时更新，可能会发生冲突
- 使用"同步删除"选项时请谨慎，它会删除目标文件夹中不存在于源文件夹的文件
- 建议在执行重要同步任务前先进行预览
- 删除操作会显示文件列表确认对话框，提高操作安全性
- 文件夹搜身和文件夹大小功能支持点击表头排序，大小和数量列按实际数值排序
- 批量操作（复制、移动、删除）支持多选，可以一次性处理多个文件/文件夹
- 删除的文件会移动到回收站（Windows系统），可从回收站恢复
- 相同文件比对基于文件内容（大小和哈希），不依赖文件名，可以识别不同文件名的相同内容

## 更新日志

### 最新更新
- 新增"文件夹大小"功能，可以分析子文件夹的大小和文件数量
- 改进"文件夹搜身"功能，支持批量复制、移动、删除操作
- 优化排序功能，文件大小和文件夹大小按实际字节数值排序
- 添加文件数量排序支持，文件夹大小功能默认按文件数量降序排列
- 改进单位换算显示，自动转换为合适的单位（B、KB、MB、GB、TB）
- 增强异常处理，提供更详细的错误信息和日志记录
- 优化移动操作的清理逻辑，移动失败时自动清理部分复制的内容
- 删除的文件会移动到回收站，可从回收站恢复
- 相同文件比对基于文件内容（大小和哈希），不依赖文件名

## 许可证

本项目采用MIT许可证 - 详情请查看LICENSE文件
